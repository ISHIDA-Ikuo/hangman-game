<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu du Pendu - Panda Park (v1.2)</title>
    <style>
        :root { --primary: #002654; --accent: #ed2939; --bg: #f3f4f6; --text: #1f2937; }
        body { font-family: sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; color: var(--text); }
        .version-badge { font-size: 0.8rem; color: #9ca3af; margin-bottom: 5px; }
        .intro { text-align: center; margin-bottom: 10px; }
        .game-container { background: white; padding: 20px; border-radius: 24px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 400px; display: flex; flex-direction: column; align-items: center; }
        
        #panda-container { height: 140px; width: 100%; display: flex; justify-content: center; align-items: center; margin-bottom: 10px; }
        #panda-img { max-height: 120px; display: none; }

        canvas { background: #fafafa; border-radius: 12px; border: 1px solid #e5e7eb; width: 180px; height: 160px; }
        #word-display { font-size: 2rem; letter-spacing: 8px; margin: 15px 0; font-weight: bold; min-height: 2.5rem; }
        #message { height: 24px; margin-bottom: 10px; font-weight: bold; font-size: 1rem; color: #6b7280; }

        .input-group { display: flex; gap: 10px; width: 100%; }
        input[type="text"] { flex-grow: 1; padding: 12px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 1.2rem; text-align: center; outline: none; transition: border 0.2s; }
        input[type="text"]:focus { border-color: var(--primary); }
        
        /* ÈñìÈÅï„Åà„ÅüÊôÇ„ÅÆÊè∫„Çå„Çã„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        .shake { animation: shake 0.4s; border-color: var(--accent) !important; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        button { background: var(--primary); color: white; border: none; padding: 12px 24px; border-radius: 12px; font-weight: bold; cursor: pointer; }
        #next-btn { background: var(--accent); width: 100%; margin-top: 10px; }
        .hidden { display: none; }
        #modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 100; }
        .modal-inner { background: white; padding: 30px; border-radius: 24px; text-align: center; }
    </style>
</head>
<body>

    <div id="modal">
        <div class="modal-inner">
            <h2>üêº Panda Park v1.2</h2>
            <p>Entrez votre nom :</p>
            <input type="text" id="user-name" placeholder="Votre nom" style="width:100%; margin-bottom:20px;">
            <button onclick="bootGame()">Jouer</button>
        </div>
    </div>

    <div class="version-badge">Version 1.2 (Focus & Shake)</div>
    <div class="intro"><h1>Panda Pendu</h1></div>

    <div class="game-container">
        <canvas id="gameCanvas" width="200" height="180"></canvas>
        <div id="panda-container"><img id="panda-img" src="" alt="Panda"></div>
        <div id="word-display">_ _ _ _</div>
        <div id="message">Pr√™t ?</div>
        
        <div id="input-ui" class="input-group">
            <input type="text" id="guess-input" maxlength="1" placeholder="?" autocomplete="off">
            <button onclick="processGuess()">OK</button>
        </div>
        <button id="next-btn" class="hidden" onclick="initRound()">Suivant</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const inputField = document.getElementById('guess-input');
        const words = ["FRANCE", "PANDA", "BAMBOU", "PARIS", "SOLEIL", "BATEAU", "ECOLE", "JARDIN"];
        let targetWord, foundLetters, usedLetters, mistakes;

        function bootGame() {
            document.getElementById('modal').style.display = 'none';
            initRound();
        }

        function initRound() {
            targetWord = words[Math.floor(Math.random() * words.length)];
            foundLetters = []; usedLetters = []; mistakes = 0;
            const pandaImg = document.getElementById('panda-img');
            pandaImg.style.display = "none";
            pandaImg.style.filter = "none";
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('input-ui').classList.remove('hidden');
            document.getElementById('message').innerText = "Devinez une lettre";
            render(); drawCanvas(0);
            
            // Ê¨°„ÅÆ„É©„Ç¶„É≥„ÉâÈñãÂßãÊôÇ„Å´Ëá™Âãï„ÅßÂÖ•ÂäõÊ¨Ñ„Å´„Éï„Ç©„Éº„Ç´„Çπ
            setTimeout(() => inputField.focus(), 100);
        }

        function render() {
            let display = "";
            for (let char of targetWord) display += foundLetters.includes(char) ? char : "_";
            document.getElementById('word-display').innerText = display;
            const pandaImg = document.getElementById('panda-img');

            if (!display.includes("_")) {
                document.getElementById('message').innerText = "üéâ BRAVO !";
                pandaImg.src = "https://45jp.net/panda/wp-content/uploads/2021/08/warau-panda.gif";
                pandaImg.style.display = "block";
                finish();
            } else if (mistakes >= 6) {
                document.getElementById('message').innerText = "üíÄ RAT√â : " + targetWord;
                pandaImg.src = "https://45jp.net/panda/wp-content/uploads/2021/08/warau-panda.png";
                pandaImg.style.display = "block";
                pandaImg.style.filter = "grayscale(100%)";
                finish();
            }
        }

        function drawCanvas(step) {
            ctx.clearRect(0,0,200,180); ctx.strokeStyle="#374151"; ctx.lineWidth=4;
            ctx.beginPath(); ctx.moveTo(20,170); ctx.lineTo(180,170); ctx.moveTo(50,170); ctx.lineTo(50,10); ctx.lineTo(130,10); ctx.lineTo(130,30); ctx.stroke();
            if(step>=1){ ctx.beginPath(); ctx.arc(130,45,15,0,Math.PI*2); ctx.stroke(); }
            if(step>=2){ ctx.beginPath(); ctx.moveTo(130,60); ctx.lineTo(130,110); ctx.stroke(); }
            if(step>=3){ ctx.beginPath(); ctx.moveTo(130,75); ctx.lineTo(110,95); ctx.stroke(); }
            if(step>=4){ ctx.beginPath(); ctx.moveTo(130,75); ctx.lineTo(150,95); ctx.stroke(); }
            if(step>=5){ ctx.beginPath(); ctx.moveTo(130,110); ctx.lineTo(110,140); ctx.stroke(); }
            if(step>=6){ ctx.beginPath(); ctx.moveTo(130,110); ctx.lineTo(150,140); ctx.stroke(); }
        }

        function processGuess() {
            const char = inputField.value.toUpperCase(); 
            inputField.value = "";
            inputField.focus(); // ÂÖ•ÂäõÂæå„Å´„Ç´„Éº„ÇΩ„É´„ÇíÊàª„Åô

            if (!char.match(/[A-Z]/)) return;
            
            if (usedLetters.includes(char)) {
                document.getElementById('message').innerText = "D√©j√† utilis√© !";
                return;
            }

            usedLetters.push(char);
            if (targetWord.includes(char)) {
                foundLetters.push(char);
                document.getElementById('message').innerText = "Bien !";
            } else {
                mistakes++;
                drawCanvas(mistakes);
                document.getElementById('message').innerText = "Non...";
                // ÈñìÈÅï„Åà„ÅüÊôÇ„Å´Êè∫„Çâ„Åô
                inputField.classList.add('shake');
                setTimeout(() => inputField.classList.remove('shake'), 400);
            }
            render();
        }

        function finish() {
            document.getElementById('input-ui').classList.add('hidden');
            document.getElementById('next-btn').classList.remove('hidden');
        }

        // Enter„Ç≠„Éº„Åß„ÇÇÈÄÅ‰ø°„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åô„Çã
        inputField.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') processGuess();
        });
    </script>
</body>
</html>
